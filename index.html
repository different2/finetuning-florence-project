<!-- Version 6.0 (Florence-2 Training Format) -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Annotation Tool - Florence-2 Format</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Image Annotation Tool - Florence-2 Training Format</h1>

    <!-- Classic Dropdown Menu Bar -->
    <div class="menu-bar">
        <!-- File Menu -->
        <div class="dropdown">
            <button class="dropbtn">File</button>
            <div class="dropdown-content">
                <a href="#" id="loadSingleImage">Load Single Image</a>
                <a href="#" id="loadFolder">Load Image Folder</a>
                <a href="#" id="setSaveDirectory">Set Save Directory</a>
                <hr>
                <a href="#" id="saveAnnotations">Save Annotations & Image</a>
            </div>
        </div>

        <!-- Tools Menu -->
        <div class="dropdown">
            <button class="dropbtn">Tools</button>
            <div class="dropdown-content">
                <a href="#" id="detectObjects">Detect Objects</a>
                <a href="#" id="autoGenerate">Auto-Generate Captions</a>
                <a href="#" id="importJson">Import Annotation JSON</a>
                <hr>
                <div class="menu-item-static">
                    <span>Box Color:</span>
                    <input type="color" id="colorPicker" value="#FF0000">
                </div>
            </div>
        </div>

        <!-- Session Menu -->
        <div class="dropdown">
            <button class="dropbtn">Session</button>
            <div class="dropdown-content">
                <a href="#" id="clearAllCache">Clear All Cached Data</a>
            </div>
        </div>

        <div id="dirStatus" class="status-box">No directory selected.</div>
    </div>

    <!-- Hidden file inputs -->
    <input type="file" id="imageLoader" accept="image/*" hidden>
    <input type="file" id="jsonLoader" accept=".json" hidden>

    <div class="main-container">
        <!-- Image Viewer -->
        <div class="image-viewer">
            <div class="canvas-container">
                <canvas id="canvas"></canvas>
            </div>
            <div class="image-nav-buttons">
                <button id="prevImage">&lt; Prev</button>
                <span id="image-counter">No image loaded</span>
                <button id="nextImage">Next &gt;</button>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="sidebar">
            <!-- Scene Controls -->
            <div class="scene-controls">
                <h4>Scene Information (Florence-2 Format)</h4>
                <label for="sceneDescription">Basic Scene Description (&lt;CAPTION&gt;):</label>
                <textarea id="sceneDescription" rows="3" placeholder="Basic scene description - auto-filled by Detect Objects"></textarea>
                
                <label for="frameTheme">Frame Theme:</label>
                <input type="text" id="frameTheme" placeholder="e.g., rainforest, gothic, modern">
                
                <label for="backgroundTheme">Background Theme:</label>
                <input type="text" id="backgroundTheme" placeholder="e.g., forest, city, ocean">
                
                <label for="isMatch">Themes Match Scene:</label>
                <select id="isMatch">
                    <option value="true">Yes (Match)</option>
                    <option value="false">No (Contrast)</option>
                </select>
                
                <label for="phraseGrounding">Artistic Analysis (&lt;MORE_DETAILED_CAPTION&gt;):</label>
                <textarea id="phraseGrounding" rows="5" placeholder="Full artistic analysis paragraph. Describe how frame relates to content, design harmony, and aesthetic quality. This is what your Discord bot will output! Click 'Auto-Generate Captions' for a starting point."></textarea>
                
                <label for="styleInput">Art Style:</label>
                <input type="text" id="styleInput" placeholder="e.g., anime, realistic, watercolor">
                
                <label for="sourceInput">Source/Series:</label>
                <input type="text" id="sourceInput" placeholder="e.g., Fate/Grand Order">
                
                <label for="artistInput">Artist:</label>
                <input type="text" id="artistInput" placeholder="e.g., official art">
            </div>

            <!-- Annotation Controls -->
            <div class="edit-controls">
                <h4>Annotation Details (&lt;DENSE_REGION_CAPTION&gt;)</h4>
                <div id="captions"></div>
                <label for="labelInput">Label (Short):</label>
                <input type="text" id="labelInput" placeholder="e.g., woman, frame, spear">
                
                <label for="objectDescription">Description (Detailed):</label>
                <textarea id="objectDescription" rows="3" placeholder="Rich description for dense region caption task"></textarea>
                
                <label for="objectAttributes">Attributes (comma-separated):</label>
                <input type="text" id="objectAttributes" placeholder="e.g., purple, gold, ornate">
                
                <button id="updateAnnotationButton">Update Annotation</button>
                <button id="deleteButton">Delete Annotation</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>